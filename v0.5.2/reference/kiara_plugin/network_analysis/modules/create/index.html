
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Markus Binsteiner">
      
      
      
        <link rel="prev" href="../__init__/">
      
      
        <link rel="next" href="../filter/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>create - kiara plugin: network_analysis</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kiara_plugin.network_analysis.modules.create" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="kiara plugin: network_analysis" class="md-header__button md-logo" aria-label="kiara plugin: network_analysis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            kiara plugin: network_analysis
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              create
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/DHARPA-Project/kiara_plugin.network_analysis" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="kiara plugin: network_analysis" class="md-nav__button md-logo" aria-label="kiara plugin: network_analysis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    kiara plugin: network_analysis
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/DHARPA-Project/kiara_plugin.network_analysis" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Package contents
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Package contents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../info/data_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    data_types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../info/module_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    module_types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../info/kiara_model_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    kiara_model_types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../info/operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    operations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    kiara_plugin
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            kiara_plugin
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../__init__/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    network_analysis
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            network_analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    data_types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../defaults/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    defaults
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../models/__init__/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    models
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_1_3" id="__nav_4_1_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    metadata
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../__init__/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    modules
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_1_4" id="__nav_4_1_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    create
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    create
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create" class="md-nav__link">
    <span class="md-ellipsis">
      create
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.KIARA_METADATA" class="md-nav__link">
    <span class="md-ellipsis">
      KIARA_METADATA
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig" class="md-nav__link">
    <span class="md-ellipsis">
      CreateNetworkDataModuleConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CreateNetworkDataModuleConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig.ignore_errors" class="md-nav__link">
    <span class="md-ellipsis">
      ignore_errors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule" class="md-nav__link">
    <span class="md-ellipsis">
      CreateNetworkDataModule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CreateNetworkDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule._config_cls" class="md-nav__link">
    <span class="md-ellipsis">
      _config_cls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule.create__network_data__from__file" class="md-nav__link">
    <span class="md-ellipsis">
      create__network_data__from__file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig" class="md-nav__link">
    <span class="md-ellipsis">
      AssembleNetworkDataModuleConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AssembleNetworkDataModuleConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.node_id_column_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      node_id_column_aliases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.label_column_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      label_column_aliases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.source_column_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      source_column_aliases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.target_column_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      target_column_aliases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule" class="md-nav__link">
    <span class="md-ellipsis">
      AssembleGraphFromTablesModule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AssembleGraphFromTablesModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule._config_cls" class="md-nav__link">
    <span class="md-ellipsis">
      _config_cls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.create_inputs_schema" class="md-nav__link">
    <span class="md-ellipsis">
      create_inputs_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.create_outputs_schema" class="md-nav__link">
    <span class="md-ellipsis">
      create_outputs_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.process" class="md-nav__link">
    <span class="md-ellipsis">
      process
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    filter
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pipelines/__init__/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pipelines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../utils/__init__/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_1_6" id="__nav_4_1_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_6">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1_6_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../utils/notebooks/__init__/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    notebooks
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_1_6_1" id="__nav_4_1_1_6_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_1_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_6_1">
            <span class="md-nav__icon md-icon"></span>
            notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/notebooks/jupyter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    jupyter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/notebooks/marimo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    marimo
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create" class="md-nav__link">
    <span class="md-ellipsis">
      create
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.KIARA_METADATA" class="md-nav__link">
    <span class="md-ellipsis">
      KIARA_METADATA
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig" class="md-nav__link">
    <span class="md-ellipsis">
      CreateNetworkDataModuleConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CreateNetworkDataModuleConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig.ignore_errors" class="md-nav__link">
    <span class="md-ellipsis">
      ignore_errors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule" class="md-nav__link">
    <span class="md-ellipsis">
      CreateNetworkDataModule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CreateNetworkDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule._config_cls" class="md-nav__link">
    <span class="md-ellipsis">
      _config_cls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule.create__network_data__from__file" class="md-nav__link">
    <span class="md-ellipsis">
      create__network_data__from__file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig" class="md-nav__link">
    <span class="md-ellipsis">
      AssembleNetworkDataModuleConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AssembleNetworkDataModuleConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.node_id_column_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      node_id_column_aliases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.label_column_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      label_column_aliases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.source_column_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      source_column_aliases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.target_column_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      target_column_aliases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule" class="md-nav__link">
    <span class="md-ellipsis">
      AssembleGraphFromTablesModule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AssembleGraphFromTablesModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule._config_cls" class="md-nav__link">
    <span class="md-ellipsis">
      _config_cls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.create_inputs_schema" class="md-nav__link">
    <span class="md-ellipsis">
      create_inputs_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.create_outputs_schema" class="md-nav__link">
    <span class="md-ellipsis">
      create_outputs_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.process" class="md-nav__link">
    <span class="md-ellipsis">
      process
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiara_plugin.network_analysis.modules.create-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>create</h1>

<div class="doc doc-object doc-module">



<a id="kiara_plugin.network_analysis.modules.create"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">





<h2 id="kiara_plugin.network_analysis.modules.create-attributes">Attributes<a href="#kiara_plugin.network_analysis.modules.create-attributes" class="headerlink" title="Permanent link">&para;</a></h2>

<div class="doc doc-object doc-attribute">



<h3 id="kiara_plugin.network_analysis.modules.create.KIARA_METADATA" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">KIARA_METADATA</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;authors&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Lena Jaskov&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;helena.jaskov@uni.lu&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Markus Binsteiner&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;markus@frkl.dev&#39;</span><span class="p">}],</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Modules to create/export network data.&#39;</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#kiara_plugin.network_analysis.modules.create.KIARA_METADATA" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

    </div>

</div>
<h2 id="kiara_plugin.network_analysis.modules.create-classes">Classes<a href="#kiara_plugin.network_analysis.modules.create-classes" class="headerlink" title="Permanent link">&para;</a></h2>

<div class="doc doc-object doc-class">



<h3 id="kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig" class="doc doc-heading">
            <code>CreateNetworkDataModuleConfig</code>


<a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="kiara.modules.included_core_modules.create_from.CreateFromModuleConfig" href="https://dharpa.org/kiara/latest/reference/kiara/modules/included_core_modules/create_from/#kiara.modules.included_core_modules.create_from.CreateFromModuleConfig">CreateFromModuleConfig</a></code></p>








              <details class="quote">
                <summary>Source code in <code>src/kiara_plugin/network_analysis/modules/create.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CreateNetworkDataModuleConfig</span><span class="p">(</span><span class="n">CreateFromModuleConfig</span><span class="p">):</span>
    <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether to ignore convert errors and omit the failed items.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">





<h4 id="kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig-attributes">Attributes<a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig-attributes" class="headerlink" title="Permanent link">&para;</a></h4>

<div class="doc doc-object doc-attribute">



<h5 id="kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig.ignore_errors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Whether to ignore convert errors and omit the failed items.&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModuleConfig.ignore_errors" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule" class="doc doc-heading">
            <code>CreateNetworkDataModule</code>


<a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="kiara.modules.included_core_modules.create_from.CreateFromModule" href="https://dharpa.org/kiara/latest/reference/kiara/modules/included_core_modules/create_from/#kiara.modules.included_core_modules.create_from.CreateFromModule">CreateFromModule</a></code></p>








              <details class="quote">
                <summary>Source code in <code>src/kiara_plugin/network_analysis/modules/create.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CreateNetworkDataModule</span><span class="p">(</span><span class="n">CreateFromModule</span><span class="p">):</span>
    <span class="n">_module_type_name</span> <span class="o">=</span> <span class="s2">&quot;create.network_data&quot;</span>
    <span class="n">_config_cls</span> <span class="o">=</span> <span class="n">CreateNetworkDataModuleConfig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create__network_data__from__file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_value</span><span class="p">:</span> <span class="n">Value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a table from a file, trying to auto-determine the format of said file.</span>

<span class="sd">        Supported file formats (at the moment):</span>
<span class="sd">        - gml</span>
<span class="sd">        - gexf</span>
<span class="sd">        - graphml (uses the standard xml library present in Python, which is insecure - see xml for additional information. Only parse GraphML files you trust)</span>
<span class="sd">        - pajek</span>
<span class="sd">        - leda</span>
<span class="sd">        - graph6</span>
<span class="sd">        - sparse6</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">source_file</span><span class="p">:</span> <span class="n">KiaraFile</span> <span class="o">=</span> <span class="n">source_value</span><span class="o">.</span><span class="n">data</span>
        <span class="c1"># the name of the attribute kiara should use to populate the node labels</span>
        <span class="n">label_attr_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># attributes to ignore when creating the node table,</span>
        <span class="c1"># mostly useful if we know that the file contains attributes that are not relevant for the network</span>
        <span class="c1"># or for &#39;label&#39;, if we don&#39;t want to duplicate the information in &#39;_label&#39; and &#39;label&#39;</span>
        <span class="n">ignore_node_attributes</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gml&quot;</span><span class="p">):</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

            <span class="c1"># we use &#39;lable=&quot;id&quot;&#39; here because networkx is fussy about labels being unique and non-null</span>
            <span class="c1"># we use the &#39;label&#39; attribute for the node labels manually later</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gml</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
            <span class="n">label_attr_name</span> <span class="o">=</span> <span class="s2">&quot;label&quot;</span>
            <span class="n">ignore_node_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gexf&quot;</span><span class="p">):</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

            <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gexf</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.graphml&quot;</span><span class="p">):</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

            <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_graphml</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.pajek&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
            <span class="s2">&quot;.net&quot;</span>
        <span class="p">):</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

            <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_pajek</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.leda&quot;</span><span class="p">):</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

            <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_leda</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
            <span class="s2">&quot;.graph6&quot;</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.g6&quot;</span><span class="p">):</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

            <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_graph6</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
            <span class="s2">&quot;.sparse6&quot;</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.s6&quot;</span><span class="p">):</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

            <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_sparse6</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">supported_file_estensions</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;gml&quot;</span><span class="p">,</span>
                <span class="s2">&quot;gexf&quot;</span><span class="p">,</span>
                <span class="s2">&quot;graphml&quot;</span><span class="p">,</span>
                <span class="s2">&quot;pajek&quot;</span><span class="p">,</span>
                <span class="s2">&quot;leda&quot;</span><span class="p">,</span>
                <span class="s2">&quot;graph6&quot;</span><span class="p">,</span>
                <span class="s2">&quot;g6&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sparse6&quot;</span><span class="p">,</span>
                <span class="s2">&quot;s6&quot;</span><span class="p">,</span>
            <span class="p">]</span>

            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Can&#39;t create network data for unsupported format of file: </span><span class="si">{</span><span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="si">}</span><span class="s2">. Supported file extensions: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">supported_file_estensions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">NetworkData</span><span class="o">.</span><span class="n">create_from_networkx_graph</span><span class="p">(</span>
            <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span>
            <span class="n">label_attr_name</span><span class="o">=</span><span class="n">label_attr_name</span><span class="p">,</span>
            <span class="n">ignore_node_attributes</span><span class="o">=</span><span class="n">ignore_node_attributes</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">





<h4 id="kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule-attributes">Attributes<a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule-attributes" class="headerlink" title="Permanent link">&para;</a></h4>

<div class="doc doc-object doc-attribute">



<h5 id="kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule._config_cls" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_config_cls</span> <span class="o">=</span> <span class="n">CreateNetworkDataModuleConfig</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule._config_cls" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<h4 id="kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule-functions">Functions<a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule-functions" class="headerlink" title="Permanent link">&para;</a></h4>

<div class="doc doc-object doc-function">


<h5 id="kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule.create__network_data__from__file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create__network_data__from__file</span><span class="p">(</span><span class="n">source_value</span><span class="p">:</span> <span class="n">Value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span></code>

<a href="#kiara_plugin.network_analysis.modules.create.CreateNetworkDataModule.create__network_data__from__file" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Create a table from a file, trying to auto-determine the format of said file.</p>
<p>Supported file formats (at the moment):
- gml
- gexf
- graphml (uses the standard xml library present in Python, which is insecure - see xml for additional information. Only parse GraphML files you trust)
- pajek
- leda
- graph6
- sparse6</p>


            <details class="quote">
              <summary>Source code in <code>src/kiara_plugin/network_analysis/modules/create.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create__network_data__from__file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_value</span><span class="p">:</span> <span class="n">Value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a table from a file, trying to auto-determine the format of said file.</span>

<span class="sd">    Supported file formats (at the moment):</span>
<span class="sd">    - gml</span>
<span class="sd">    - gexf</span>
<span class="sd">    - graphml (uses the standard xml library present in Python, which is insecure - see xml for additional information. Only parse GraphML files you trust)</span>
<span class="sd">    - pajek</span>
<span class="sd">    - leda</span>
<span class="sd">    - graph6</span>
<span class="sd">    - sparse6</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">source_file</span><span class="p">:</span> <span class="n">KiaraFile</span> <span class="o">=</span> <span class="n">source_value</span><span class="o">.</span><span class="n">data</span>
    <span class="c1"># the name of the attribute kiara should use to populate the node labels</span>
    <span class="n">label_attr_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># attributes to ignore when creating the node table,</span>
    <span class="c1"># mostly useful if we know that the file contains attributes that are not relevant for the network</span>
    <span class="c1"># or for &#39;label&#39;, if we don&#39;t want to duplicate the information in &#39;_label&#39; and &#39;label&#39;</span>
    <span class="n">ignore_node_attributes</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gml&quot;</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

        <span class="c1"># we use &#39;lable=&quot;id&quot;&#39; here because networkx is fussy about labels being unique and non-null</span>
        <span class="c1"># we use the &#39;label&#39; attribute for the node labels manually later</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gml</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
        <span class="n">label_attr_name</span> <span class="o">=</span> <span class="s2">&quot;label&quot;</span>
        <span class="n">ignore_node_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gexf&quot;</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gexf</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.graphml&quot;</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_graphml</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.pajek&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
        <span class="s2">&quot;.net&quot;</span>
    <span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_pajek</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.leda&quot;</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_leda</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
        <span class="s2">&quot;.graph6&quot;</span>
    <span class="p">)</span> <span class="ow">or</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.g6&quot;</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_graph6</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
        <span class="s2">&quot;.sparse6&quot;</span>
    <span class="p">)</span> <span class="ow">or</span> <span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.s6&quot;</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_sparse6</span><span class="p">(</span><span class="n">source_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">supported_file_estensions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;gml&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gexf&quot;</span><span class="p">,</span>
            <span class="s2">&quot;graphml&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pajek&quot;</span><span class="p">,</span>
            <span class="s2">&quot;leda&quot;</span><span class="p">,</span>
            <span class="s2">&quot;graph6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;g6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sparse6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;s6&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Can&#39;t create network data for unsupported format of file: </span><span class="si">{</span><span class="n">source_file</span><span class="o">.</span><span class="n">file_name</span><span class="si">}</span><span class="s2">. Supported file extensions: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">supported_file_estensions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">NetworkData</span><span class="o">.</span><span class="n">create_from_networkx_graph</span><span class="p">(</span>
        <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span>
        <span class="n">label_attr_name</span><span class="o">=</span><span class="n">label_attr_name</span><span class="p">,</span>
        <span class="n">ignore_node_attributes</span><span class="o">=</span><span class="n">ignore_node_attributes</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig" class="doc doc-heading">
            <code>AssembleNetworkDataModuleConfig</code>


<a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="kiara.models.module.KiaraModuleConfig" href="https://dharpa.org/kiara/latest/reference/kiara/models/module/__init__/#kiara.models.module.KiaraModuleConfig">KiaraModuleConfig</a></code></p>








              <details class="quote">
                <summary>Source code in <code>src/kiara_plugin/network_analysis/modules/create.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AssembleNetworkDataModuleConfig</span><span class="p">(</span><span class="n">KiaraModuleConfig</span><span class="p">):</span>
    <span class="n">node_id_column_aliases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Alias strings to test (in order) for auto-detecting the node id column.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">NODE_ID_ALIAS_NAMES</span><span class="p">,</span>
    <span class="p">)</span>  <span class="c1"># pydantic should handle that correctly (deepcopy) -- and anyway, it&#39;s immutable (hopefully)</span>
    <span class="n">label_column_aliases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Alias strings to test (in order) for auto-detecting the node label column.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">LABEL_ALIAS_NAMES</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">source_column_aliases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Alias strings to test (in order) for auto-detecting the source column.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">SOURCE_COLUMN_ALIAS_NAMES</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">target_column_aliases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Alias strings to test (in order) for auto-detecting the target column.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">TARGET_COLUMN_ALIAS_NAMES</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">





<h4 id="kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig-attributes">Attributes<a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig-attributes" class="headerlink" title="Permanent link">&para;</a></h4>

<div class="doc doc-object doc-attribute">



<h5 id="kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.node_id_column_aliases" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">node_id_column_aliases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Alias strings to test (in order) for auto-detecting the node id column.&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">NODE_ID_ALIAS_NAMES</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.node_id_column_aliases" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.label_column_aliases" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">label_column_aliases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Alias strings to test (in order) for auto-detecting the node label column.&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">LABEL_ALIAS_NAMES</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.label_column_aliases" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.source_column_aliases" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_column_aliases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Alias strings to test (in order) for auto-detecting the source column.&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">SOURCE_COLUMN_ALIAS_NAMES</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.source_column_aliases" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.target_column_aliases" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">target_column_aliases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Alias strings to test (in order) for auto-detecting the target column.&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">TARGET_COLUMN_ALIAS_NAMES</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#kiara_plugin.network_analysis.modules.create.AssembleNetworkDataModuleConfig.target_column_aliases" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule" class="doc doc-heading">
            <code>AssembleGraphFromTablesModule</code>


<a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="kiara.api.KiaraModule" href="https://dharpa.org/kiara/latest/reference/kiara/api/#kiara.api.KiaraModule">KiaraModule</a></code></p>


        <p>Create a 'network_data' instance from one or two tables.</p>
<p>This module needs at least one table as input, providing the edges of the resulting network data set.
If no further table is created, basic node information will be automatically created by using unique values from the edges source and target columns.</p>
<p>If no <code>source_column_name</code> (and/or <code>target_column_name</code>) is provided, <em>kiara</em> will try to auto-detect the most likely of the existing columns to use. If that is not possible, an error will be raised.</p>







              <details class="quote">
                <summary>Source code in <code>src/kiara_plugin/network_analysis/modules/create.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AssembleGraphFromTablesModule</span><span class="p">(</span><span class="n">KiaraModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a &#39;network_data&#39; instance from one or two tables.</span>

<span class="sd">    This module needs at least one table as input, providing the edges of the resulting network data set.</span>
<span class="sd">    If no further table is created, basic node information will be automatically created by using unique values from the edges source and target columns.</span>

<span class="sd">    If no `source_column_name` (and/or `target_column_name`) is provided, *kiara* will try to auto-detect the most likely of the existing columns to use. If that is not possible, an error will be raised.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_module_type_name</span> <span class="o">=</span> <span class="s2">&quot;assemble.network_data&quot;</span>
    <span class="n">_config_cls</span> <span class="o">=</span> <span class="n">AssembleNetworkDataModuleConfig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_inputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueMapSchema</span><span class="p">:</span>
        <span class="n">inputs</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A table that contains the edges data.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;source_column&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The name of the source column name in the edges table.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;target_column&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The name of the target column name in the edges table.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;edges_column_map&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;dict&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;An optional map of original column name to desired.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A table that contains the nodes data.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;id_column&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The name (before any potential column mapping) of the node-table column that contains the node identifier (used in the edges table).&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;label_column&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The name of a column that contains the node label (before any potential column name mapping). If not specified, the value of the id value will be used as label.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;nodes_column_map&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;dict&quot;</span><span class="p">,</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;An optional map of original column name to desired.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">inputs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_outputs_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueMapSchema</span><span class="p">:</span>
        <span class="n">outputs</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;network_data&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;network_data&quot;</span><span class="p">,</span> <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The network/graph data.&quot;</span><span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">outputs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">job_log</span><span class="p">:</span> <span class="n">JobLog</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>

        <span class="c1"># process nodes</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;nodes&quot;</span><span class="p">)</span>

        <span class="c1"># the nodes column map can be used to rename attribute columns in the nodes table</span>
        <span class="n">nodes_column_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;nodes_column_map&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nodes_column_map</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nodes_column_map</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># we need to process the nodes first, because if we have nodes, we need to create the node id map that translates from the original</span>
        <span class="c1"># id to the new, internal, integer-based one</span>

        <span class="k">if</span> <span class="n">nodes</span><span class="o">.</span><span class="n">is_set</span><span class="p">:</span>
            <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="s2">&quot;processing nodes table&quot;</span><span class="p">)</span>

            <span class="n">nodes_table</span><span class="p">:</span> <span class="n">KiaraTable</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">data</span>
            <span class="k">assert</span> <span class="n">nodes_table</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

            <span class="n">nodes_column_names</span> <span class="o">=</span> <span class="n">nodes_table</span><span class="o">.</span><span class="n">column_names</span>

            <span class="c1"># the most important column is the id column, which is the only one that we absolutely need to have</span>
            <span class="n">id_column_name</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;id_column&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">id_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># try to auto-detect the id column</span>
                <span class="n">column_names_to_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;node_id_column_aliases&quot;</span><span class="p">)</span>
                <span class="n">id_column_name</span> <span class="o">=</span> <span class="n">guess_node_id_column_name</span><span class="p">(</span>
                    <span class="n">nodes_table</span><span class="o">=</span><span class="n">nodes_table</span><span class="p">,</span> <span class="n">suggestions</span><span class="o">=</span><span class="n">column_names_to_test</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">id_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Could not auto-determine id column name. Please specify one manually, using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nodes_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;auto-detected id column: </span><span class="si">{</span><span class="n">id_column_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">id_column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodes_column_names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Could not find id column &#39;</span><span class="si">{</span><span class="n">id_column_name</span><span class="si">}</span><span class="s2">&#39; in the nodes table. Please specify a valid column name manually, using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nodes_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="n">nodes_column_map</span><span class="p">[</span><span class="n">id_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">NODE_ID_COLUMN_NAME</span>
            <span class="k">if</span> <span class="n">id_column_name</span> <span class="ow">in</span> <span class="n">nodes_column_map</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">nodes_column_map</span><span class="p">[</span><span class="n">id_column_name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NODE_ID_COLUMN_NAME</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Existing mapping of id column name &#39;</span><span class="si">{</span><span class="n">id_column_name</span><span class="si">}</span><span class="s2">&#39; is not mapped to &#39;</span><span class="si">{</span><span class="n">NODE_ID_COLUMN_NAME</span><span class="si">}</span><span class="s2">&#39; in the &#39;nodes_column_map&#39; input.&quot;</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nodes_column_map</span><span class="p">[</span><span class="n">id_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">NODE_ID_COLUMN_NAME</span>

            <span class="c1"># the label is optional, if not specified, we try to auto-detect it. If not possible, we will use the (stringified) id column as label.</span>
            <span class="n">label_column_name</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;label_column&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">label_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">column_names_to_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;label_column_aliases&quot;</span><span class="p">)</span>
                <span class="n">label_column_name</span> <span class="o">=</span> <span class="n">guess_node_label_column_name</span><span class="p">(</span>
                    <span class="n">nodes_table</span><span class="o">=</span><span class="n">nodes_table</span><span class="p">,</span> <span class="n">suggestions</span><span class="o">=</span><span class="n">column_names_to_test</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">label_column_name</span> <span class="ow">and</span> <span class="n">label_column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodes_column_names</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Could not find id column &#39;</span><span class="si">{</span><span class="n">id_column_name</span><span class="si">}</span><span class="s2">&#39; in the nodes table. Please specify a valid column name manually, using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nodes_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">label_column_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;auto-detected label column: </span><span class="si">{</span><span class="n">label_column_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span>
                        <span class="s2">&quot;no label column found, will use id column as label&quot;</span>
                    <span class="p">)</span>

            <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="n">nodes_table</span><span class="o">.</span><span class="n">to_polars_dataframe</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">label_column_name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># process edges</span>

        <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="s2">&quot;processing edges table&quot;</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;edges&quot;</span><span class="p">)</span>
        <span class="n">edges_table</span><span class="p">:</span> <span class="n">KiaraTable</span> <span class="o">=</span> <span class="n">edges</span><span class="o">.</span><span class="n">data</span>
        <span class="n">edges_source_column_name</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;source_column&quot;</span><span class="p">)</span>
        <span class="n">edges_target_column_name</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;target_column&quot;</span><span class="p">)</span>

        <span class="n">edges_arrow_dataframe</span> <span class="o">=</span> <span class="n">edges_table</span><span class="o">.</span><span class="n">to_polars_dataframe</span><span class="p">()</span>
        <span class="n">edges_column_names</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">if</span> <span class="n">edges_source_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">column_names_to_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;source_column_aliases&quot;</span><span class="p">)</span>
            <span class="n">edges_source_column_name</span> <span class="o">=</span> <span class="n">guess_source_column_name</span><span class="p">(</span>
                <span class="n">edges_table</span><span class="o">=</span><span class="n">edges_table</span><span class="p">,</span> <span class="n">suggestions</span><span class="o">=</span><span class="n">column_names_to_test</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">edges_target_column_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;auto-detected source column: </span><span class="si">{</span><span class="n">edges_source_column_name</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">edges_target_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">column_names_to_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;target_column_aliases&quot;</span><span class="p">)</span>
            <span class="n">edges_target_column_name</span> <span class="o">=</span> <span class="n">guess_target_column_name</span><span class="p">(</span>
                <span class="n">edges_table</span><span class="o">=</span><span class="n">edges_table</span><span class="p">,</span> <span class="n">suggestions</span><span class="o">=</span><span class="n">column_names_to_test</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">edges_target_column_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;auto-detected target column: </span><span class="si">{</span><span class="n">edges_target_column_name</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">edges_source_column_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">edges_target_column_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">edges_source_column_name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">edges_target_column_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span>
                        <span class="s2">&quot;using first two columns as source and target columns&quot;</span>
                    <span class="p">)</span>
                    <span class="n">edges_source_column_name</span> <span class="o">=</span> <span class="n">edges_column_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">edges_target_column_name</span> <span class="o">=</span> <span class="n">edges_column_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Could not auto-detect source and target column names. Please specify them manually using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">edges_source_column_name</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Could not auto-detect source column name. Please specify it manually using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">edges_target_column_name</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Could not auto-detect target column name. Please specify it manually using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

        <span class="n">edges_column_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;edges_column_map&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">edges_column_map</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">edges_column_map</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">edges_source_column_name</span> <span class="ow">in</span> <span class="n">edges_column_map</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">edges_column_map</span><span class="p">[</span><span class="n">edges_source_column_name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">SOURCE_COLUMN_NAME</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Existing mapping of source column name &#39;</span><span class="si">{</span><span class="n">edges_source_column_name</span><span class="si">}</span><span class="s2">&#39; is not mapped to &#39;</span><span class="si">{</span><span class="n">SOURCE_COLUMN_NAME</span><span class="si">}</span><span class="s2">&#39; in the &#39;edges_column_map&#39; input.&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">edges_column_map</span><span class="p">[</span><span class="n">edges_source_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">SOURCE_COLUMN_NAME</span>

        <span class="k">if</span> <span class="n">edges_target_column_name</span> <span class="ow">in</span> <span class="n">edges_column_map</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">edges_column_map</span><span class="p">[</span><span class="n">edges_target_column_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">SOURCE_COLUMN_NAME</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Edges and source column names can&#39;t be the same.&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">edges_column_map</span><span class="p">[</span><span class="n">edges_target_column_name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">TARGET_COLUMN_NAME</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Existing mapping of target column name &#39;</span><span class="si">{</span><span class="n">edges_target_column_name</span><span class="si">}</span><span class="s2">&#39; is not mapped to &#39;</span><span class="si">{</span><span class="n">TARGET_COLUMN_NAME</span><span class="si">}</span><span class="s2">&#39; in the &#39;edges_column_map&#39; input.&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">edges_column_map</span><span class="p">[</span><span class="n">edges_target_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">TARGET_COLUMN_NAME</span>

        <span class="k">if</span> <span class="n">edges_source_column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">edges_column_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Edges table does not contain source column &#39;</span><span class="si">{</span><span class="n">edges_source_column_name</span><span class="si">}</span><span class="s2">&#39;. Choose one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">edges_target_column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">edges_column_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Edges table does not contain target column &#39;</span><span class="si">{</span><span class="n">edges_target_column_name</span><span class="si">}</span><span class="s2">&#39;. Choose one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="n">source_column_old</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">edges_source_column_name</span><span class="p">)</span>
        <span class="n">target_column_old</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">edges_target_column_name</span><span class="p">)</span>

        <span class="n">source_column_old_str</span> <span class="o">=</span> <span class="n">source_column_old</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>
        <span class="n">target_column_old_str</span> <span class="o">=</span> <span class="n">target_column_old</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>

        <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="s2">&quot;generating node id map and nodes table&quot;</span><span class="p">)</span>
        <span class="c1"># fill out the node id map</span>
        <span class="n">unique_node_ids_old</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">source_column_old_str</span><span class="p">,</span> <span class="n">target_column_old_str</span><span class="p">],</span> <span class="n">rechunk</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="o">.</span><span class="n">unique</span><span class="p">()</span>
            <span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">nodes_arrow_dataframe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_node_ids</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_node_ids_old</span><span class="p">))</span>  <span class="c1"># noqa: PIE808</span>
            <span class="n">node_id_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique_node_ids_old</span><span class="p">,</span> <span class="n">new_node_ids</span><span class="p">))</span>
            <span class="c1"># node_id_map = {</span>
            <span class="c1">#     node_id: new_node_id</span>
            <span class="c1">#     for node_id, new_node_id in</span>
            <span class="c1"># }</span>

            <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="n">NODE_ID_COLUMN_NAME</span><span class="p">:</span> <span class="n">new_node_ids</span><span class="p">,</span>
                    <span class="n">LABEL_COLUMN_NAME</span><span class="p">:</span> <span class="n">unique_node_ids_old</span><span class="p">,</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">unique_node_ids_old</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">id_column_old</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">id_column_name</span><span class="p">)</span>
            <span class="n">id_column_old_str</span> <span class="o">=</span> <span class="n">id_column_old</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>
            <span class="n">unique_node_ids_nodes_table</span> <span class="o">=</span> <span class="n">id_column_old_str</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

            <span class="n">missing_node_ids</span> <span class="o">=</span> <span class="n">unique_node_ids_old</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="o">~</span><span class="n">unique_node_ids_old</span><span class="o">.</span><span class="n">is_in</span><span class="p">(</span><span class="n">unique_node_ids_nodes_table</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># replace the id column with the stringified version</span>
            <span class="n">idx_column_old</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">get_column_index</span><span class="p">(</span><span class="n">id_column_name</span><span class="p">)</span>
            <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">replace_column</span><span class="p">(</span>
                <span class="n">idx_column_old</span><span class="p">,</span> <span class="n">id_column_old_str</span>
            <span class="p">)</span>

            <span class="c1"># Create a new dataframe with missing nodes</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_node_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Get the schema from the existing nodes dataframe</span>
                <span class="n">missing_nodes_data</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="c1"># cast the missing_node_ids to a list of strings</span>
                <span class="n">missing_node_ids</span> <span class="o">=</span> <span class="n">missing_node_ids</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>

                <span class="c1"># Set the node ID column (before mapping) with the missing IDs</span>
                <span class="n">missing_nodes_data</span><span class="p">[</span><span class="n">id_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_node_ids</span>

                <span class="c1"># Fill other columns with None values</span>
                <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">col_name</span> <span class="o">==</span> <span class="n">label_column_name</span><span class="p">:</span>
                        <span class="n">missing_nodes_data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_node_ids</span>
                    <span class="k">elif</span> <span class="n">col_name</span> <span class="o">!=</span> <span class="n">id_column_name</span><span class="p">:</span>
                        <span class="c1"># Create a series of None values with the same length as missing_node_ids</span>
                        <span class="n">missing_nodes_data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_node_ids</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

                <span class="c1"># Create the new dataframe</span>
                <span class="n">missing_nodes_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">missing_nodes_data</span><span class="p">)</span>

                <span class="c1"># Concatenate with the existing nodes dataframe</span>
                <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">nodes_arrow_dataframe</span><span class="p">,</span> <span class="n">missing_nodes_df</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">id_column_old_str</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">id_column_name</span><span class="p">)</span>

            <span class="n">new_node_ids</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">id_column_old_str</span><span class="p">))</span>  <span class="c1"># noqa: PIE808</span>
            <span class="n">node_id_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">id_column_old_str</span><span class="p">,</span> <span class="n">new_node_ids</span><span class="p">))</span>

            <span class="n">new_idx_series</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">NODE_ID_COLUMN_NAME</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">new_node_ids</span><span class="p">)</span>

            <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">insert_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_idx_series</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">label_column_name</span><span class="p">:</span>
                <span class="n">label_column_name</span> <span class="o">=</span> <span class="n">NODE_ID_COLUMN_NAME</span>

            <span class="c1"># we create a copy of the label column, and stringify its items</span>

            <span class="n">label_column</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">label_column_name</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                <span class="n">LABEL_COLUMN_NAME</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">label_column</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">:</span>
                <span class="n">label_column</span> <span class="o">=</span> <span class="n">label_column</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">label_column</span><span class="o">.</span><span class="n">null_count</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Label column &#39;</span><span class="si">{</span><span class="n">label_column_name</span><span class="si">}</span><span class="s2">&#39; contains null values. This is not allowed.&quot;</span>
                <span class="p">)</span>

            <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">insert_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">label_column</span><span class="p">)</span>

        <span class="c1"># TODO: deal with different types if node ids are strings or integers</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">source_column_mapped</span> <span class="o">=</span> <span class="n">source_column_old_str</span><span class="o">.</span><span class="n">replace_strict</span><span class="p">(</span>
                <span class="n">node_id_map</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">SOURCE_COLUMN_NAME</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="s2">&quot;Could not map node ids onto edges source column.  In most cases the issue is that your node ids have a different data type in your nodes table as in the source column of your edges table.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">source_column_mapped</span><span class="o">.</span><span class="n">is_null</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="s2">&quot;The source column contains values that are not mapped in the nodes table.&quot;</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">target_column_mapped</span> <span class="o">=</span> <span class="n">target_column_old_str</span><span class="o">.</span><span class="n">replace_strict</span><span class="p">(</span>
                <span class="n">node_id_map</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">TARGET_COLUMN_NAME</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="s2">&quot;Could not map node ids onto edges source column.  In most cases the issue is that your node ids have a different data type in your nodes table as in the target column of your edges table.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">target_column_mapped</span><span class="o">.</span><span class="n">is_null</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="s2">&quot;The target column contains values that are not mapped in the nodes table.&quot;</span>
            <span class="p">)</span>

        <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">insert_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">source_column_mapped</span><span class="p">)</span>
        <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">insert_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">target_column_mapped</span><span class="p">)</span>

        <span class="n">edges_arrow_dataframe</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">edges_source_column_name</span><span class="p">)</span>
        <span class="n">edges_arrow_dataframe</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">edges_target_column_name</span><span class="p">)</span>

        <span class="n">edges_arrow_table</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">()</span>
        <span class="c1"># edges_table_augmented = augment_edges_table_with_weights(edges_arrow_dataframe)</span>

        <span class="c1"># # TODO: also index the other columns?</span>
        <span class="c1"># edges_data_schema = create_sqlite_schema_data_from_arrow_table(</span>
        <span class="c1">#     table=edges_arrow_dataframe,</span>
        <span class="c1">#     index_columns=[SOURCE_COLUMN_NAME, TARGET_COLUMN_NAME],</span>
        <span class="c1">#     column_map=edges_column_map,</span>
        <span class="c1"># )</span>

        <span class="n">nodes_arrow_table</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">()</span>

        <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="s2">&quot;creating network data instance&quot;</span><span class="p">)</span>
        <span class="n">network_data</span> <span class="o">=</span> <span class="n">NetworkData</span><span class="o">.</span><span class="n">create_network_data</span><span class="p">(</span>
            <span class="n">nodes_table</span><span class="o">=</span><span class="n">nodes_arrow_table</span><span class="p">,</span> <span class="n">edges_table</span><span class="o">=</span><span class="n">edges_arrow_table</span>
        <span class="p">)</span>

        <span class="n">outputs</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;network_data&quot;</span><span class="p">,</span> <span class="n">network_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">





<h4 id="kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule-attributes">Attributes<a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule-attributes" class="headerlink" title="Permanent link">&para;</a></h4>

<div class="doc doc-object doc-attribute">



<h5 id="kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule._config_cls" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_config_cls</span> <span class="o">=</span> <span class="n">AssembleNetworkDataModuleConfig</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule._config_cls" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<h4 id="kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule-functions">Functions<a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule-functions" class="headerlink" title="Permanent link">&para;</a></h4>

<div class="doc doc-object doc-function">


<h5 id="kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.create_inputs_schema" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_inputs_schema</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ValueMapSchema</span></code>

<a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.create_inputs_schema" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>src/kiara_plugin/network_analysis/modules/create.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_inputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueMapSchema</span><span class="p">:</span>
    <span class="n">inputs</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A table that contains the edges data.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;source_column&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The name of the source column name in the edges table.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;target_column&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The name of the target column name in the edges table.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;edges_column_map&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;dict&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;An optional map of original column name to desired.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;A table that contains the nodes data.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;id_column&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The name (before any potential column mapping) of the node-table column that contains the node identifier (used in the edges table).&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;label_column&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The name of a column that contains the node label (before any potential column name mapping). If not specified, the value of the id value will be used as label.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;nodes_column_map&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;dict&quot;</span><span class="p">,</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;An optional map of original column name to desired.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optional&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">inputs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.create_outputs_schema" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_outputs_schema</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ValueMapSchema</span></code>

<a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.create_outputs_schema" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>src/kiara_plugin/network_analysis/modules/create.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_outputs_schema</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValueMapSchema</span><span class="p">:</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;network_data&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;network_data&quot;</span><span class="p">,</span> <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;The network/graph data.&quot;</span><span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">outputs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.process" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">job_log</span><span class="p">:</span> <span class="n">JobLog</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

<a href="#kiara_plugin.network_analysis.modules.create.AssembleGraphFromTablesModule.process" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>src/kiara_plugin/network_analysis/modules/create.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">ValueMap</span><span class="p">,</span> <span class="n">job_log</span><span class="p">:</span> <span class="n">JobLog</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>

    <span class="c1"># process nodes</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;nodes&quot;</span><span class="p">)</span>

    <span class="c1"># the nodes column map can be used to rename attribute columns in the nodes table</span>
    <span class="n">nodes_column_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;nodes_column_map&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nodes_column_map</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nodes_column_map</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># we need to process the nodes first, because if we have nodes, we need to create the node id map that translates from the original</span>
    <span class="c1"># id to the new, internal, integer-based one</span>

    <span class="k">if</span> <span class="n">nodes</span><span class="o">.</span><span class="n">is_set</span><span class="p">:</span>
        <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="s2">&quot;processing nodes table&quot;</span><span class="p">)</span>

        <span class="n">nodes_table</span><span class="p">:</span> <span class="n">KiaraTable</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">data</span>
        <span class="k">assert</span> <span class="n">nodes_table</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="n">nodes_column_names</span> <span class="o">=</span> <span class="n">nodes_table</span><span class="o">.</span><span class="n">column_names</span>

        <span class="c1"># the most important column is the id column, which is the only one that we absolutely need to have</span>
        <span class="n">id_column_name</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;id_column&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">id_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># try to auto-detect the id column</span>
            <span class="n">column_names_to_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;node_id_column_aliases&quot;</span><span class="p">)</span>
            <span class="n">id_column_name</span> <span class="o">=</span> <span class="n">guess_node_id_column_name</span><span class="p">(</span>
                <span class="n">nodes_table</span><span class="o">=</span><span class="n">nodes_table</span><span class="p">,</span> <span class="n">suggestions</span><span class="o">=</span><span class="n">column_names_to_test</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">id_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Could not auto-determine id column name. Please specify one manually, using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nodes_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;auto-detected id column: </span><span class="si">{</span><span class="n">id_column_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">id_column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodes_column_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Could not find id column &#39;</span><span class="si">{</span><span class="n">id_column_name</span><span class="si">}</span><span class="s2">&#39; in the nodes table. Please specify a valid column name manually, using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nodes_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">nodes_column_map</span><span class="p">[</span><span class="n">id_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">NODE_ID_COLUMN_NAME</span>
        <span class="k">if</span> <span class="n">id_column_name</span> <span class="ow">in</span> <span class="n">nodes_column_map</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">nodes_column_map</span><span class="p">[</span><span class="n">id_column_name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NODE_ID_COLUMN_NAME</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Existing mapping of id column name &#39;</span><span class="si">{</span><span class="n">id_column_name</span><span class="si">}</span><span class="s2">&#39; is not mapped to &#39;</span><span class="si">{</span><span class="n">NODE_ID_COLUMN_NAME</span><span class="si">}</span><span class="s2">&#39; in the &#39;nodes_column_map&#39; input.&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nodes_column_map</span><span class="p">[</span><span class="n">id_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">NODE_ID_COLUMN_NAME</span>

        <span class="c1"># the label is optional, if not specified, we try to auto-detect it. If not possible, we will use the (stringified) id column as label.</span>
        <span class="n">label_column_name</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;label_column&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">column_names_to_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;label_column_aliases&quot;</span><span class="p">)</span>
            <span class="n">label_column_name</span> <span class="o">=</span> <span class="n">guess_node_label_column_name</span><span class="p">(</span>
                <span class="n">nodes_table</span><span class="o">=</span><span class="n">nodes_table</span><span class="p">,</span> <span class="n">suggestions</span><span class="o">=</span><span class="n">column_names_to_test</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">label_column_name</span> <span class="ow">and</span> <span class="n">label_column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodes_column_names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Could not find id column &#39;</span><span class="si">{</span><span class="n">id_column_name</span><span class="si">}</span><span class="s2">&#39; in the nodes table. Please specify a valid column name manually, using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nodes_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">label_column_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;auto-detected label column: </span><span class="si">{</span><span class="n">label_column_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span>
                    <span class="s2">&quot;no label column found, will use id column as label&quot;</span>
                <span class="p">)</span>

        <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="n">nodes_table</span><span class="o">.</span><span class="n">to_polars_dataframe</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">label_column_name</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># process edges</span>

    <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="s2">&quot;processing edges table&quot;</span><span class="p">)</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_obj</span><span class="p">(</span><span class="s2">&quot;edges&quot;</span><span class="p">)</span>
    <span class="n">edges_table</span><span class="p">:</span> <span class="n">KiaraTable</span> <span class="o">=</span> <span class="n">edges</span><span class="o">.</span><span class="n">data</span>
    <span class="n">edges_source_column_name</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;source_column&quot;</span><span class="p">)</span>
    <span class="n">edges_target_column_name</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;target_column&quot;</span><span class="p">)</span>

    <span class="n">edges_arrow_dataframe</span> <span class="o">=</span> <span class="n">edges_table</span><span class="o">.</span><span class="n">to_polars_dataframe</span><span class="p">()</span>
    <span class="n">edges_column_names</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">columns</span>

    <span class="k">if</span> <span class="n">edges_source_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">column_names_to_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;source_column_aliases&quot;</span><span class="p">)</span>
        <span class="n">edges_source_column_name</span> <span class="o">=</span> <span class="n">guess_source_column_name</span><span class="p">(</span>
            <span class="n">edges_table</span><span class="o">=</span><span class="n">edges_table</span><span class="p">,</span> <span class="n">suggestions</span><span class="o">=</span><span class="n">column_names_to_test</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">edges_target_column_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;auto-detected source column: </span><span class="si">{</span><span class="n">edges_source_column_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">edges_target_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">column_names_to_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_value</span><span class="p">(</span><span class="s2">&quot;target_column_aliases&quot;</span><span class="p">)</span>
        <span class="n">edges_target_column_name</span> <span class="o">=</span> <span class="n">guess_target_column_name</span><span class="p">(</span>
            <span class="n">edges_table</span><span class="o">=</span><span class="n">edges_table</span><span class="p">,</span> <span class="n">suggestions</span><span class="o">=</span><span class="n">column_names_to_test</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">edges_target_column_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;auto-detected target column: </span><span class="si">{</span><span class="n">edges_target_column_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">edges_source_column_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">edges_target_column_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">edges_source_column_name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">edges_target_column_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span>
                    <span class="s2">&quot;using first two columns as source and target columns&quot;</span>
                <span class="p">)</span>
                <span class="n">edges_source_column_name</span> <span class="o">=</span> <span class="n">edges_column_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">edges_target_column_name</span> <span class="o">=</span> <span class="n">edges_column_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Could not auto-detect source and target column names. Please specify them manually using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">edges_source_column_name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Could not auto-detect source column name. Please specify it manually using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">edges_target_column_name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Could not auto-detect target column name. Please specify it manually using one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="n">edges_column_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_value_data</span><span class="p">(</span><span class="s2">&quot;edges_column_map&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">edges_column_map</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">edges_column_map</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">edges_source_column_name</span> <span class="ow">in</span> <span class="n">edges_column_map</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">edges_column_map</span><span class="p">[</span><span class="n">edges_source_column_name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">SOURCE_COLUMN_NAME</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Existing mapping of source column name &#39;</span><span class="si">{</span><span class="n">edges_source_column_name</span><span class="si">}</span><span class="s2">&#39; is not mapped to &#39;</span><span class="si">{</span><span class="n">SOURCE_COLUMN_NAME</span><span class="si">}</span><span class="s2">&#39; in the &#39;edges_column_map&#39; input.&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">edges_column_map</span><span class="p">[</span><span class="n">edges_source_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">SOURCE_COLUMN_NAME</span>

    <span class="k">if</span> <span class="n">edges_target_column_name</span> <span class="ow">in</span> <span class="n">edges_column_map</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">edges_column_map</span><span class="p">[</span><span class="n">edges_target_column_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">SOURCE_COLUMN_NAME</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Edges and source column names can&#39;t be the same.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">edges_column_map</span><span class="p">[</span><span class="n">edges_target_column_name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">TARGET_COLUMN_NAME</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Existing mapping of target column name &#39;</span><span class="si">{</span><span class="n">edges_target_column_name</span><span class="si">}</span><span class="s2">&#39; is not mapped to &#39;</span><span class="si">{</span><span class="n">TARGET_COLUMN_NAME</span><span class="si">}</span><span class="s2">&#39; in the &#39;edges_column_map&#39; input.&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">edges_column_map</span><span class="p">[</span><span class="n">edges_target_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">TARGET_COLUMN_NAME</span>

    <span class="k">if</span> <span class="n">edges_source_column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">edges_column_names</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Edges table does not contain source column &#39;</span><span class="si">{</span><span class="n">edges_source_column_name</span><span class="si">}</span><span class="s2">&#39;. Choose one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">edges_target_column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">edges_column_names</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Edges table does not contain target column &#39;</span><span class="si">{</span><span class="n">edges_target_column_name</span><span class="si">}</span><span class="s2">&#39;. Choose one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">edges_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="n">source_column_old</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">edges_source_column_name</span><span class="p">)</span>
    <span class="n">target_column_old</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">edges_target_column_name</span><span class="p">)</span>

    <span class="n">source_column_old_str</span> <span class="o">=</span> <span class="n">source_column_old</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>
    <span class="n">target_column_old_str</span> <span class="o">=</span> <span class="n">target_column_old</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>

    <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="s2">&quot;generating node id map and nodes table&quot;</span><span class="p">)</span>
    <span class="c1"># fill out the node id map</span>
    <span class="n">unique_node_ids_old</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">source_column_old_str</span><span class="p">,</span> <span class="n">target_column_old_str</span><span class="p">],</span> <span class="n">rechunk</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">nodes_arrow_dataframe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">new_node_ids</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_node_ids_old</span><span class="p">))</span>  <span class="c1"># noqa: PIE808</span>
        <span class="n">node_id_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique_node_ids_old</span><span class="p">,</span> <span class="n">new_node_ids</span><span class="p">))</span>
        <span class="c1"># node_id_map = {</span>
        <span class="c1">#     node_id: new_node_id</span>
        <span class="c1">#     for node_id, new_node_id in</span>
        <span class="c1"># }</span>

        <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="n">NODE_ID_COLUMN_NAME</span><span class="p">:</span> <span class="n">new_node_ids</span><span class="p">,</span>
                <span class="n">LABEL_COLUMN_NAME</span><span class="p">:</span> <span class="n">unique_node_ids_old</span><span class="p">,</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">unique_node_ids_old</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">id_column_old</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">id_column_name</span><span class="p">)</span>
        <span class="n">id_column_old_str</span> <span class="o">=</span> <span class="n">id_column_old</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>
        <span class="n">unique_node_ids_nodes_table</span> <span class="o">=</span> <span class="n">id_column_old_str</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">missing_node_ids</span> <span class="o">=</span> <span class="n">unique_node_ids_old</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="o">~</span><span class="n">unique_node_ids_old</span><span class="o">.</span><span class="n">is_in</span><span class="p">(</span><span class="n">unique_node_ids_nodes_table</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># replace the id column with the stringified version</span>
        <span class="n">idx_column_old</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">get_column_index</span><span class="p">(</span><span class="n">id_column_name</span><span class="p">)</span>
        <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">replace_column</span><span class="p">(</span>
            <span class="n">idx_column_old</span><span class="p">,</span> <span class="n">id_column_old_str</span>
        <span class="p">)</span>

        <span class="c1"># Create a new dataframe with missing nodes</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_node_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Get the schema from the existing nodes dataframe</span>
            <span class="n">missing_nodes_data</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1"># cast the missing_node_ids to a list of strings</span>
            <span class="n">missing_node_ids</span> <span class="o">=</span> <span class="n">missing_node_ids</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>

            <span class="c1"># Set the node ID column (before mapping) with the missing IDs</span>
            <span class="n">missing_nodes_data</span><span class="p">[</span><span class="n">id_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_node_ids</span>

            <span class="c1"># Fill other columns with None values</span>
            <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">col_name</span> <span class="o">==</span> <span class="n">label_column_name</span><span class="p">:</span>
                    <span class="n">missing_nodes_data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_node_ids</span>
                <span class="k">elif</span> <span class="n">col_name</span> <span class="o">!=</span> <span class="n">id_column_name</span><span class="p">:</span>
                    <span class="c1"># Create a series of None values with the same length as missing_node_ids</span>
                    <span class="n">missing_nodes_data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_node_ids</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

            <span class="c1"># Create the new dataframe</span>
            <span class="n">missing_nodes_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">missing_nodes_data</span><span class="p">)</span>

            <span class="c1"># Concatenate with the existing nodes dataframe</span>
            <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                <span class="p">[</span><span class="n">nodes_arrow_dataframe</span><span class="p">,</span> <span class="n">missing_nodes_df</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">id_column_old_str</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">id_column_name</span><span class="p">)</span>

        <span class="n">new_node_ids</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">id_column_old_str</span><span class="p">))</span>  <span class="c1"># noqa: PIE808</span>
        <span class="n">node_id_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">id_column_old_str</span><span class="p">,</span> <span class="n">new_node_ids</span><span class="p">))</span>

        <span class="n">new_idx_series</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">NODE_ID_COLUMN_NAME</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">new_node_ids</span><span class="p">)</span>

        <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">insert_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_idx_series</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">label_column_name</span><span class="p">:</span>
            <span class="n">label_column_name</span> <span class="o">=</span> <span class="n">NODE_ID_COLUMN_NAME</span>

        <span class="c1"># we create a copy of the label column, and stringify its items</span>

        <span class="n">label_column</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">label_column_name</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">LABEL_COLUMN_NAME</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">label_column</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">:</span>
            <span class="n">label_column</span> <span class="o">=</span> <span class="n">label_column</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">label_column</span><span class="o">.</span><span class="n">null_count</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Label column &#39;</span><span class="si">{</span><span class="n">label_column_name</span><span class="si">}</span><span class="s2">&#39; contains null values. This is not allowed.&quot;</span>
            <span class="p">)</span>

        <span class="n">nodes_arrow_dataframe</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">insert_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">label_column</span><span class="p">)</span>

    <span class="c1"># TODO: deal with different types if node ids are strings or integers</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">source_column_mapped</span> <span class="o">=</span> <span class="n">source_column_old_str</span><span class="o">.</span><span class="n">replace_strict</span><span class="p">(</span>
            <span class="n">node_id_map</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">SOURCE_COLUMN_NAME</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
            <span class="s2">&quot;Could not map node ids onto edges source column.  In most cases the issue is that your node ids have a different data type in your nodes table as in the source column of your edges table.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">source_column_mapped</span><span class="o">.</span><span class="n">is_null</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
            <span class="s2">&quot;The source column contains values that are not mapped in the nodes table.&quot;</span>
        <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">target_column_mapped</span> <span class="o">=</span> <span class="n">target_column_old_str</span><span class="o">.</span><span class="n">replace_strict</span><span class="p">(</span>
            <span class="n">node_id_map</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">TARGET_COLUMN_NAME</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
            <span class="s2">&quot;Could not map node ids onto edges source column.  In most cases the issue is that your node ids have a different data type in your nodes table as in the target column of your edges table.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">target_column_mapped</span><span class="o">.</span><span class="n">is_null</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">KiaraProcessingException</span><span class="p">(</span>
            <span class="s2">&quot;The target column contains values that are not mapped in the nodes table.&quot;</span>
        <span class="p">)</span>

    <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">insert_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">source_column_mapped</span><span class="p">)</span>
    <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">insert_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">target_column_mapped</span><span class="p">)</span>

    <span class="n">edges_arrow_dataframe</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">edges_source_column_name</span><span class="p">)</span>
    <span class="n">edges_arrow_dataframe</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">edges_target_column_name</span><span class="p">)</span>

    <span class="n">edges_arrow_table</span> <span class="o">=</span> <span class="n">edges_arrow_dataframe</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">()</span>
    <span class="c1"># edges_table_augmented = augment_edges_table_with_weights(edges_arrow_dataframe)</span>

    <span class="c1"># # TODO: also index the other columns?</span>
    <span class="c1"># edges_data_schema = create_sqlite_schema_data_from_arrow_table(</span>
    <span class="c1">#     table=edges_arrow_dataframe,</span>
    <span class="c1">#     index_columns=[SOURCE_COLUMN_NAME, TARGET_COLUMN_NAME],</span>
    <span class="c1">#     column_map=edges_column_map,</span>
    <span class="c1"># )</span>

    <span class="n">nodes_arrow_table</span> <span class="o">=</span> <span class="n">nodes_arrow_dataframe</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">()</span>

    <span class="n">job_log</span><span class="o">.</span><span class="n">add_log</span><span class="p">(</span><span class="s2">&quot;creating network data instance&quot;</span><span class="p">)</span>
    <span class="n">network_data</span> <span class="o">=</span> <span class="n">NetworkData</span><span class="o">.</span><span class="n">create_network_data</span><span class="p">(</span>
        <span class="n">nodes_table</span><span class="o">=</span><span class="n">nodes_arrow_table</span><span class="p">,</span> <span class="n">edges_table</span><span class="o">=</span><span class="n">edges_arrow_table</span>
    <span class="p">)</span>

    <span class="n">outputs</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;network_data&quot;</span><span class="p">,</span> <span class="n">network_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
<h2 id="kiara_plugin.network_analysis.modules.create-functions">Functions<a href="#kiara_plugin.network_analysis.modules.create-functions" class="headerlink" title="Permanent link">&para;</a></h2>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.tracking"], "search": "../../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>